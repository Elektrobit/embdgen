# Cominit verity sample
# This generates a single partition (root)
# with cominit metadata append to a dm verity partition.
# The actual partition data (i.e. ext4 formatted image) is already available in a root.raw file.
# The hashtable for the verity partition is generated by embdgen as well (content type verity).
# This also creates a file with the verity metadata information, that is read be the cominit content
# module and inserted into the metadata

type: mbr

parts:
  - name: root
    type: partition
    fstype: ext4
    content:
      type:       cominit
      key:        files/private-key.pem
      dm_type:    verity
      readonly:   true
      filesystem: ext4
      metadata:   tmp/root.verity-meta
      content:
        type:     verity
        metadata: tmp/root.verity-meta
        content:
          type: raw
          file: files/root.raw
